from pwn import *
import os
import time

in_read = os.open("/tmp/pipein", os.O_RDWR)
in_write = os.open("/tmp/pipein", os.O_WRONLY)
out_read = os.open("/tmp/pipeout", os.O_RDWR)
out_write = os.open("/tmp/pipeout", os.O_WRONLY)

p_in = process(["cat", "-"], stdout=in_write)
p = process(["/challenge/embryoio_level106"], stdin=in_read, stdout=out_write)
p_out = process(["cat", "-"], stdin=out_read)

delimiter = b"solution for: "
for _ in range(1):
	p_out.recvuntil(delimiter)
	msg = p_out.recvline()[:-1]

	expr = msg.decode()
	result = eval(expr)
	p_in.sendline(str(result).encode('utf-8'))

print(p_out.clean())


p.wait()
