from pwn import *
import signal
import json
import time

sig_dict = {}
for sig in signal.Signals:
	sig_dict[sig.name] = sig

p = process(["./a.out"])
p.recvuntil(b"send me (PID ")
pid = int(p.recvuntil(b")")[:-1], 10)

p.recvuntil(b"in exactly this order: ")
sig_arr_raw = p.recvuntil(b"]")
sig_arr_raw = sig_arr_raw.replace(b"'", b"\"").decode()
sig_arr = json.loads(sig_arr_raw)

for i in range(len(sig_arr)):
	os.kill(pid, sig_dict[sig_arr[i]])
	time.sleep(0.3)
	print(p.clean())

p.interactive()
